pkgver="0.$_gover"
_url="https://github.com/epiphyte/synapse-tools"
url="$_url/tree/master/hooks/$pkgname"
license=('MIT')
makedepends=('go' 'git')
depends=()
source=("git+$_url")
sha512sums=('SKIP')
_src=synapse-tools/hooks

build() {
    cd $_src/$pkgname
    make $_make_args
}

package() {
    local _pkgdir=/opt/epiphyte/$pkgname
    mkdir -p "$pkgdir/$_pkgdir"
    cd $_src/$pkgname
    install -Dm644 $pkgname.service $pkgdir/usr/lib/systemd/system/$pkgname.service
    install -Dm644 $pkgname.conf $pkgdir/etc/epiphyte.d/$pkgname.conf
    install -Dm 755 $pkgname.sh $pkgdir/$_pkgdir/$pkgname.sh
    install -Dm 755 $pkgname $pkgdir/$_pkgdir/.$pkgname
    install -Dm644 scripts/phab-http-reports.timer $pkgdir/usr/lib/systemd/system/phab-http-reports.timer
    install -Dm644 scripts/phab-http-reports.service $pkgdir/usr/lib/systemd/system/phab-http-reports.service
    install -Dm 755 scripts/reports.sh $pkgdir/$_pkgdir/reports.sh
}
